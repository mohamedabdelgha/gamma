{% load static %}
{% load arabic_days %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href=" {% static "css/style.css" %} ">
    <title>client page</title>
</head>
<body>
    <div class="maincon">
        <div id="clientcon">
            <h2> فاتورة العميل : <span>{{client.name}}</span></h2>
        </div>
        <div id="bottomclientCon">
            <button class="print" id="printall">طباعة الكل</button>
            <table class="mintable1">
                <thead>
                    <tr>
                        <th colspan="4">التفاصيل</th>
                    </tr>
                </thead>
                <tbody id="tablecolbody">
                    <tr>
                        <td style="border-right: 1px solid #625D5D;">عليه</td>
                    </tr>
                    <tr>
                        <td style="border-right: 1px solid #625D5D;"><span>{{client.rest}}</span> جنيه</td>
                    </tr>
                </tbody>
            </table>
        </div> 
        <div class="window" id="windowcon">
            <i id="closedetwin" class="fa-solid fa-xmark close" ></i>
            <div id="detailcontainer">
                
            </div>
        </div>
        <!-- selectdate container -->
        <!-- <div id="selectdatecon" class="window" style="position: fixed; top: 15%;">
            <i id="closeseldatecon" class="fa-solid fa-xmark close"></i>
            <div class="datesinp">
                <h3> _____ برجاء تحديد التاريخ _____</h3>
                <div>
                    <span>من بعد : </span>
                    <input type="date" id="startDate">
                </div>
                <div>
                    <span>الى : </span>
                    <input type="date" id="endDate">
                </div>
                <button class="print" style="width: 30%;" id="filterButton">معاينة و طباعة</button>
            </div>
        </div> -->
        <!-- print container -->
        <!-- <div id="printcon" class="window" style="display: none;">
            <i id="closeprintcon" class="fa-solid fa-xmark close"></i>
            <i id="printbtn" class="fa-solid fa-print printing"></i>
            <div id="printcontent"style="direction:ltr;">
                <img src="{% static "images/logo.png" %}" alt="">
                <div style="width: 90%;border-radius: 10px;margin: 0; border: 1px solid #625D5D; text-align: center;padding:0px 2px;display: flex;align-items: center;justify-content: space-around;flex-direction: row;">
                    <span style="font-size: 20px;">تحريراً فــى : <span id="billDate">date</span></span>
                    <span style="font-size: 25px;">مطلوب من : {{client.name}}</span>
                </div><br>
                <table id="myprintTable">
                    <thead>
                        <tr>
                            <th>اليوم</th>
                            <th>التاريخ</th>
                            <th>الصنف</th>
                            <th>السعر</th>
                            <th>الوزن</th>
                            <th>العدد</th>
                            <th>المبلغ</th>
                        </tr>
                    </thead>
                    <tbody id="tableprintbody">
                        
                    </tbody>
                </table>
                <table class="mintable1">
                    <thead>
                        <tr>
                            <th>التفاصيل</th>
                        </tr>
                    </thead>
                    <tbody id="tablecolbody">
                        <tr>
                            <td>الباقى : <span id="spantotal">{{client.rest}}</span> جنيه</td>
                        </tr>
                    </tbody>
                </table>
            </div>    
        </div> -->
        <!-- printall container -->
        <div id="printallcon" class="window" style="display: none;">
            <i id="closeprintallcon" class="fa-solid fa-xmark close"></i>
            <i id="printallbtn" class="fa-solid fa-print printing"></i>
            <div id="printallcontent" style="direction:ltr;">
                <img src="{% static "images/logo.png" %}" alt="">
                <div style="width: 90%;border-radius: 10px;margin: 0; border: 1px solid #625D5D; text-align: center;padding:0px 2px;display: flex;align-items: center;justify-content: space-around;flex-direction: row;">
                    <span style="font-size: 20px;">تحريراً فــى : <span id="billDate">date</span></span>
                    <span style="font-size: 25px;">مطلوب من : {{client.name}}</span>
                </div><br>
                <table id="myprintTable">
                    <thead>
                        <tr>
                            <th>اليوم</th>
                            <th>التاريخ</th>
                            <th>نوع العملية</th>
                            <th>عدد الورق</th>
                            <th>عدد النسخ</th>
                            <th>السعر</th>
                            <th>الاجمالى</th>
                            <th>عربون</th>
                        </tr>
                    </thead>
                    <tbody id="tableprintallbody">
                        
                    </tbody>
                </table>
                <table class="mintable1">
                    <thead>
                        <tr>
                            <th>التفاصيل</th>
                        </tr>
                    </thead>
                    <tbody id="tablecolbody">
                        <tr>
                            <td>الباقى : <span id="spantotal">{{client.rest}}</span> جنيه</td>
                        </tr>
                    </tbody>
                </table>
            </div>    
        </div>
        <div class="rightcon">
            <div class="minhead">
                <img src=" {% static "images/logo.png" %} " alt="">
            </div>
            <ul>
                <i class="fa-solid fa-arrow-left" id="rightconexpend"></i>
                <a href="{% url "sales" %}">
                    <li>
                        <i class="fa-solid fa-house-circle-check"></i>
                        <span>الصفحة الرئيسية</span>
                    </li>
                </a>
                <a href="{% url "clients" %}">
                    <li class="activeli">
                        <i class="fa-solid fa-users"></i>
                        <span>العملاء</span>
                    </li>
                </a>
                <a href="{% url "profits" %}">
                    <li>
                        <i class="fa-solid fa-circle-info"></i>
                        <span>استعلام عن رصيد</span>
                    </li>
                </a>
                {% if user.first_name == 'adminName' %}
                <a href="{% url "adminPage" %}">
                    <li>
                        <i class="fa-solid fa-user-tie"></i>
                        <span>المسئول</span>
                    </li>
                </a>
                {% endif %}
            </ul>
            <div class="minfoot">
                <a href="{% url "logout" %}">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i>
                </a>
                <span>{{user.username}}</span>
            </div>
        </div>
        <div class="leftcon" id="leftcon"> 
            <div class="status">
                <h2>صفحة عميل</h2>
                {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                    <div class="statuscon">
                        <div style="width:500px; margin-left : 50px;">
                            <h3>اسم العميل</h3>
                            <h2><span id="income">{{client.name}}</span></h2>
                        </div>
                        <div style="width:500px; margin-left : 50px;">
                            <h3>الباقى</h3>
                            <h2><span id="loseing">{{client.rest}}</span> جنيه</h2>
                        </div>
                        <div style="width:500px; margin-left : 50px;">
                            <h3>الرصيد الافتتاحى</h3>
                            <h2><span id="remain">{{client.opening_balance}}</span> جنيه</h2>
                        </div>
                    </div>
            </div>
            <div class="status">
                <h2>جميع العمليات</h2><br>
                <!-- <button class="print" id="print">طباعة</button> -->
                <button class="print" id="printall">طباعة الكل</button>
                <div style="width: 100%; overflow: scroll;">
                    <table class="sellstable">
                        <thead>
                            <tr>
                                <th>اليوم</th>
                                <th>التاريخ</th>
                                <th>نوع العملية</th>
                                <th>عدد الورق</th>
                                <th>عدد النسخ</th>
                                <th>السعر</th>
                                <th>الاجمالى</th>
                                <th>عربون</th>
                                {% if user.first_name == "شبه مسئول" or user.first_name == 'adminName' %}
                                <th>حذف</th>
                                {% endif %}
                            </tr>
                        </thead>
                        <tbody id="tablebody">
                            {% for sale in sales %}
                            <tr>
                                <td>{{sale.date|date:"w"|arabic_days}}</td>
                                <td>{{sale.date|date:"20y/m/d"}}</td>
                                <td>{{sale.item}}</td>
                                <td>{{sale.paper_num}}</td>
                                <td>{{sale.copies_num}}</td>
                                <td>{{sale.price}}</td>
                                <td>{{sale.total}}</td>
                                <td>{{sale.paid}}</td>
                                {% if user.first_name == "شبه مسئول" or user.first_name == 'adminName' %}
                                <td><button class="sellsdel" id="sellsdel" metadata='
                                    <form method="post" action="{% url "saleDelete" sale.id %}" style="width: 100%;display: flex;align-items: center;justify-content: center;flex-direction: column;">
                                        {% csrf_token %}
                                        <div class="addsell" style="padding: 20px;flex-direction:column;">
                                            <h3 style="color:#3D4B64;">حذف عملية</h3>
                                            <h3 style="color:#FF0000;">"حذف العملية سيؤدى الى حذف جميع المتعلقات بها"</h3>
                                            <br>
                                            <i class="fa-regular fa-trash-can" style="color: #ff3333;font-size: 100px;"></i>
                                            <br>
                                        </div>
                                        <button name="saleDelete2" class="sellbtn">حذف</button>
                                    </form>
                                    '><i class="fa-solid fa-trash-can"></i></button></td>
                                    {% endif %}
                                </tr>
                                {% endfor %}
                                {% for payment in payments %}
                                <tr style="background-color : #90FF95 ;font-size: bold ;">
                                    <td>{{ payment.date|date:"w"|arabic_days }}</td>
                                    <td>{{ payment.date|date:"20y/m/d"}}</td>
                                    <td colspan="5">تم دفع</td>
                                    <td>{{ payment.paid_money }}</td>
                                    <td></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src=" {% static "js/clientpage.js" %} "></script>
</body>
</html>